<!doctype html>



  


<html class="theme-next mist use-motion" lang="zh-tw">
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Langevin Dynamics,MCMC,HMC,Metropolis Hastings,Hamiltonian Dynamic,Hamiltonian Monte Carlo,Langevin Monte Carlo,Denoising Diffusion Probabilistic Models,Diffusion Model," />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.0" />






<meta name="description" content="2024/07/28 æ›´æ–° (è¦‹æœ¬æ–‡æœ€å¾Œä¸€æ®µ): è£œå……èˆ‡ Langevin Dynamics çš„é—œä¿‚, é€™æ˜¯æˆ‘å€‘åœ¨ [Score Matching ç³»åˆ— (äº”) SM åŠ ä¸Š Langevin Dynamics è®Šæˆç”Ÿæˆæ¨¡å‹] è£¡æåˆ°ä¸€æ—¦è¨“ç·´å‡º score function å¾Œ, æ¨¡å‹ä½¿ç”¨çš„æ¡æ¨£æŠ€è¡“. å¦å¤– Score Match + Langevin Dynamics (SMLD) é€™ç¨®">
<meta property="og:type" content="article">
<meta property="og:title" content="å¿˜è¨˜ç‰©ç†ä¹Ÿè¦ææ‡‚çš„ Hamiltonian Monte Carlo (HMC) ç­†è¨˜">
<meta property="og:url" content="https://bobondemon.github.io/2022/05/07/Hamiltonian-Monte-Carlo/index.html">
<meta property="og:site_name" content="æ£’æ£’ç”Ÿ">
<meta property="og:description" content="2024/07/28 æ›´æ–° (è¦‹æœ¬æ–‡æœ€å¾Œä¸€æ®µ): è£œå……èˆ‡ Langevin Dynamics çš„é—œä¿‚, é€™æ˜¯æˆ‘å€‘åœ¨ [Score Matching ç³»åˆ— (äº”) SM åŠ ä¸Š Langevin Dynamics è®Šæˆç”Ÿæˆæ¨¡å‹] è£¡æåˆ°ä¸€æ—¦è¨“ç·´å‡º score function å¾Œ, æ¨¡å‹ä½¿ç”¨çš„æ¡æ¨£æŠ€è¡“. å¦å¤– Score Match + Langevin Dynamics (SMLD) é€™ç¨®">
<meta property="og:image" content="https://bobondemon.github.io/2022/05/07/Hamiltonian-Monte-Carlo/Untitled.png">
<meta property="og:image" content="https://bobondemon.github.io/2022/05/07/Hamiltonian-Monte-Carlo/hamiltoniandynamics.gif">
<meta property="og:image" content="https://bobondemon.github.io/2022/05/07/Hamiltonian-Monte-Carlo/Untitled 1.png">
<meta property="og:image" content="https://bobondemon.github.io/2022/05/07/Hamiltonian-Monte-Carlo/Untitled 2.png">
<meta property="og:image" content="https://bobondemon.github.io/2022/05/07/Hamiltonian-Monte-Carlo/Untitled 3.png">
<meta property="og:image" content="https://bobondemon.github.io/2022/05/07/Hamiltonian-Monte-Carlo/Langevin_Monte_Carlo.png">
<meta property="og:updated_time" content="2024-07-28T07:55:23.336Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="å¿˜è¨˜ç‰©ç†ä¹Ÿè¦ææ‡‚çš„ Hamiltonian Monte Carlo (HMC) ç­†è¨˜">
<meta name="twitter:description" content="2024/07/28 æ›´æ–° (è¦‹æœ¬æ–‡æœ€å¾Œä¸€æ®µ): è£œå……èˆ‡ Langevin Dynamics çš„é—œä¿‚, é€™æ˜¯æˆ‘å€‘åœ¨ [Score Matching ç³»åˆ— (äº”) SM åŠ ä¸Š Langevin Dynamics è®Šæˆç”Ÿæˆæ¨¡å‹] è£¡æåˆ°ä¸€æ—¦è¨“ç·´å‡º score function å¾Œ, æ¨¡å‹ä½¿ç”¨çš„æ¡æ¨£æŠ€è¡“. å¦å¤– Score Match + Langevin Dynamics (SMLD) é€™ç¨®">
<meta name="twitter:image" content="https://bobondemon.github.io/2022/05/07/Hamiltonian-Monte-Carlo/Untitled.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: 'åšä¸»'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://bobondemon.github.io/2022/05/07/Hamiltonian-Monte-Carlo/"/>





  <title> å¿˜è¨˜ç‰©ç†ä¹Ÿè¦ææ‡‚çš„ Hamiltonian Monte Carlo (HMC) ç­†è¨˜ | æ£’æ£’ç”Ÿ </title><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-tw">

  














  
  
    
  

  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="container sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">æ£’æ£’ç”Ÿ</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">è®“å­¸ç¿’è®Šæˆä¸€ç¨®ç¿’æ…£</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            é¦–é 
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            åˆ†é¡
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            é—œæ–¼
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            æ­¸æª”
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            æ¨™ç±¤
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://bobondemon.github.io/2022/05/07/Hamiltonian-Monte-Carlo/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Chih-Sheng Chen">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="æ£’æ£’ç”Ÿ">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                å¿˜è¨˜ç‰©ç†ä¹Ÿè¦ææ‡‚çš„ Hamiltonian Monte Carlo (HMC) ç­†è¨˜
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">ç™¼è¡¨æ–¼</span>
              
              <time title="å‰µå»ºæ–¼" itemprop="dateCreated datePublished" datetime="2022-05-07T18:09:02+08:00">
                2022-05-07
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">åˆ†é¡æ–¼</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/ML/" itemprop="url" rel="index">
                    <span itemprop="name">ML</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          
            <span class="post-meta-divider">|</span>
            <span class="page-pv"><i class="fa fa-file-o"></i>
            <span class="busuanzi-value" id="busuanzi_value_page_pv" ></span>[object Object]
            </span>
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

<hr>
<ul>
<li>2024/07/28 æ›´æ–° (è¦‹æœ¬æ–‡æœ€å¾Œä¸€æ®µ): è£œå……èˆ‡ Langevin Dynamics çš„é—œä¿‚, é€™æ˜¯æˆ‘å€‘åœ¨ [<a href="https://bobondemon.github.io/2022/03/26/Generative-Modeling-by-Estimating-Gradients-of-the-Data-Distribution/">Score Matching ç³»åˆ— (äº”) SM åŠ ä¸Š Langevin Dynamics è®Šæˆç”Ÿæˆæ¨¡å‹</a>] è£¡æåˆ°ä¸€æ—¦è¨“ç·´å‡º score function å¾Œ, æ¨¡å‹ä½¿ç”¨çš„æ¡æ¨£æŠ€è¡“. å¦å¤– Score Match + Langevin Dynamics (SMLD) é€™ç¨®ç”Ÿæˆæ¨¡å‹äº‹å¯¦ä¸Šè·Ÿ <a href="https://arxiv.org/abs/2006.11239" target="_blank" rel="external">DDPM (Denoising Diffusion Probabilistic Models)</a> æ˜¯ä¸€æ¨£çš„! Yang Song é€™ç¯‡ 2021 ICLR best paper award (<a href="https://arxiv.org/abs/2011.13456" target="_blank" rel="external">Score-Based Generative Modeling through Stochastic Differential Equations</a>) é—¡æ˜äº† SMLD è·Ÿ DDPM å…¶å¯¦æ˜¯å…©ç¨®ä¸åŒçš„è§€é», éƒ½å¯ä»¥ç”¨ç›¸åŒçš„ SDE (Stochastic Differential Equation) ä¾†è¡¨é”.</li>
</ul>
<p>å…ˆèªªæˆ‘ç‰©ç†ä»€éº¼çš„éƒ½é‚„çµ¦è€å¸«äº†, åªèƒ½ç”¨è‡ªå·±ç†è§£çš„æ–¹å¼, ç­†è¨˜ä¸‹ <strong>Hamiltonian dynamic.</strong></p>
<blockquote>
<p>ã€€ğŸ’¡ å¦‚æœé€£æˆ‘éƒ½èƒ½æ‡‚, ç›¸ä¿¡å¤§å®¶éƒ½èƒ½ç†è§£ HMC äº†</p>
</blockquote>
<p>ä½†é‚„æ˜¯<strong>å»ºè­°å…ˆçœ‹ <a href="https://bobondemon.github.io/2021/10/27/MCMC-by-Gibbs-and-Metropolis-Hasting-Sampling/">MCMC by Gibbs and Metropolis-Hasting Sampling</a></strong>, å› ç‚ºé€™ç¯‡è¦èªªçš„ Hamiltonian Monte Carlo (HMC) æ˜¯ Metropolis-Hastings (MH) æ–¹æ³•çš„ä¸€ç¨®, åªæ˜¯ proposal distribution å¾ random walk æ”¹æˆä½¿ç”¨ Hamiltonian dynamics ä¾†åš, å› è€Œè®Šçš„éå¸¸æœ‰æ•ˆç‡ (accept rate å¾ˆé«˜), ä¸”å°æ–¼é«˜ç¶­åº¦è³‡æ–™æ¡æ¨£ä¹Ÿå¾ˆæœ‰æ•ˆ.</p>
<p>é¦–å…ˆç²—é«”å­—å¦‚ <span>$\mathbf{x}, \mathbf{v}, \mathbf{p}$</span><!-- Has MathJax --> éƒ½æ˜¯ column vector, è€Œéç²—é«”å­—è¡¨ scalar, e.g. $m,t$</p>
<a id="more"></a>
<h2 id="Hamiltonian-dynamic"><a href="#Hamiltonian-dynamic" class="headerlink" title="Hamiltonian dynamic"></a><strong>Hamiltonian dynamic</strong></h2><hr>
<p>ä¸€ç‰©é«”åœ¨ä½ç½® $\mathbf{x}$ (é€™è£¡å¯æƒ³æˆæ˜¯é«˜åº¦) çš„é‡åŠ›ä½èƒ½ (potential energy) ç‚º</p>
<span>$$\begin{align}
U(\mathbf{x})=m\mathbf{g}^T\mathbf{x}
\end{align}$$</span><!-- Has MathJax -->
<p>å…¶ä¸­ $m$ è¡¨è³ªé‡, $\mathbf{g}$ è¡¨é‡åŠ›åŠ é€Ÿåº¦ (æ˜¯å€‹å‘é‡, æ‰€ä»¥æœ‰æ–¹å‘æ€§).<br>åŒæ™‚è©²ç‰©é«”, å…¶æœ¬èº«ä¹Ÿå­˜åœ¨å‹•èƒ½ (kinetic energy) ä¸”å¯è¡¨ç¤ºç‚º:</p>
<span>$$\begin{align}
K(\mathbf{p})=\frac{\mathbf{p}^T\mathbf{p}}{2m}\left(=\frac{1}{2}m\mathbf{v}^2\right) \\
\mathbf{p}=m\frac{d\mathbf{x}}{dt}\left(=m\mathbf{v}\right)
\end{align}$$</span><!-- Has MathJax -->
<p>$\mathbf{v}$ è¡¨é€Ÿåº¦ (æ˜¯å€‹å‘é‡, æ‰€ä»¥æœ‰æ–¹å‘æ€§), $\mathbf{p}$ æˆ‘å€‘ç¨±ç‚ºå‹•é‡ (momentum).<br>æ•´å€‹å°é–‰ç³»çµ± (æ²’æœ‰å¤–ç•Œçš„å…¶ä»–èƒ½é‡ä»‹å…¥) çš„èƒ½é‡ç‚º:</p>
<span>$$\begin{align}
H(\mathbf{x},\mathbf{p})=U(\mathbf{x})+K(\mathbf{p}) \\
=m\mathbf{g}^T\mathbf{x}+\frac{\mathbf{p}^T\mathbf{p}}{2m}
\end{align}$$</span><!-- Has MathJax -->
<p>æ ¹æ“š<strong>èƒ½é‡å®ˆæ† (energy conservation)</strong>, ä¸ç®¡æ™‚é–“ $t$ æ˜¯ä»€éº¼, æ•´å€‹ç³»çµ±çš„èƒ½é‡ $H(\mathbf{x},\mathbf{p})$ éƒ½ç¶­æŒç›¸åŒ.<br>æ­¤æ™‚å¦‚æœæˆ‘å€‘çŸ¥é“è©²ç‰©é«”çš„åˆå§‹ç‹€æ…‹ $(\mathbf{x}_0,\mathbf{p}_0)$ çš„è©±, äº‹å¯¦ä¸Šå¯ä»¥çŸ¥é“ä»»ä½•æ™‚é–“ $t$ ä¸‹çš„ä½ç½®å’Œå‹•é‡ $(\mathbf{x},\mathbf{p})$<br>è€Œé€™æ¨£çš„é—œä¿‚å¯ä»¥ç”±ä¸‹é¢çš„ <strong>Hamiltonian equations</strong> æè¿°å‡ºä¾†:</p>
<span>$$\begin{align}
\frac{dx_i}{dt}=\frac{\partial H}{\partial p_i} \\
\frac{dp_i}{dt}=-\frac{\partial H}{\partial x_i}
\end{align}$$</span><!-- Has MathJax -->
<p>å…¶ä¸­ <span>$i\in\{1,..,d\}$</span><!-- Has MathJax -->, $d$ è¡¨ç©ºé–“çš„ç¶­åº¦.</p>
<blockquote>
<p>åªè¦ä½¿ç”¨ $\mathbf{p}=m\mathbf{v}$, é€Ÿåº¦ $\mathbf{v}$ æ˜¯ $\mathbf{x}$ å°æ™‚é–“çš„å¾®åˆ†, ä»¥åŠ<br>é€Ÿåº¦å°æ™‚é–“çš„å¾®åˆ†ç­‰æ–¼è² åŠ é€Ÿåº¦ $-\mathbf{g}$ (åº§æ¨™ç³»çµ±å®šç¾©ç‚ºå¾€ä¸Šçš„åº§æ¨™æ˜¯æ­£çš„, è€Œé‡åŠ›åŠ é€Ÿåº¦æ˜¯å‘ä¸‹çš„, æ‰€ä»¥å€¼ç‚ºè² )<br>å°±å¯ä»¥å¾ (5) æ¨å°å‡º (6) å’Œ (7).<br><span>$$\frac{\partial H}{\partial p_i}=\frac{\partial K(\mathbf{p})}{\partial p_i}=\frac{\partial}{\partial p_i}\frac{\sum_j p_j^2}{2m}=\frac{p_i}{m}=\frac{m v_i}{m}=v_i=\frac{dx_i}{dt}
\\
\frac{\partial H}{\partial x_i}=\frac{\partial U(\mathbf{x})}{\partial x_i}=\frac{\partial m\sum_j g_jx_j}{\partial x_i}=mg_i=m\frac{d(-v_i)}{dt}=-\frac{dmv_i}{dt}=-\frac{dp_i}{dt}$$</span><!-- Has MathJax --></p>
</blockquote>
<p>æ‰€ä»¥å¦‚æœå·²çŸ¥æ™‚é–“ $t$ çš„ä½ç½® $x_i(t)$, æƒ³é ä¼° $t+\varepsilon$ çš„ä½ç½® $x_i(t+\varepsilon)$ çš„è©±, å¯ä»¥é€é (6) çš„æ–¹å¼æ›´æ–°:</p>
<span>$$x_i(t+\varepsilon)\approx x_i(t)+\varepsilon\cdot\frac{dx_i(t)}{dt}=x_i(t)+\varepsilon\cdot\frac{\partial K(\mathbf{p}(t))}{\partial p_i} \\
=x_i(t)+\varepsilon\cdot\frac{\partial\left(\mathbf{p}(t)^T\mathbf{p}(t)/2m\right)}{\partial p_i} = x_i(t)+\varepsilon\cdot\frac{p_i(t)}{m}$$</span><!-- Has MathJax -->
<p>åªè¦ $\varepsilon$ å¤ å°çš„è©±, å°±æœƒå¤ æ¥è¿‘.<br>åŒç† $p_i(t+\varepsilon)$ ä¹Ÿèƒ½ç”¨ (7) ä¼°è¨ˆå‡ºä¾†. ç¸½çµç‚ºä»¥ä¸‹ update æ–¹æ³• (ä»¤ $m=1$), è€Œé€™å€‹æ–¹æ³•ç¨±ç‚º Eulerâ€™s method:</p>
<span>$$\begin{align}
x_i(t+\varepsilon) = x_i(t)+\varepsilon\cdot p_i(t) \\
p_i(t+\varepsilon) = p_i(t)-\varepsilon\cdot\frac{\partial U(\mathbf{x}(t))}{\partial x_i}
\end{align}$$</span><!-- Has MathJax -->
<p>ä½†è‡´å‘½çš„ç¼ºé»æ˜¯ä¸€æ—¦æ™‚é–“é•·äº†, ä¼°è¨ˆå°±æ„ˆä¾†æ„ˆä¸æº–äº†. å› æ­¤å¯¦ä½œä¸Šæœƒæ¡ç”¨ Leapfrog method: <a href="https://www2.atmos.umd.edu/~ekalnay/syllabi/AOSC614/NWP-CH03-2-2.pdf" target="_blank" rel="external">pdf ä»‹ç´¹</a>.<br>æˆ‘å€‘å…ˆçœ‹çœ‹å…©ç¨®æ–¹æ³•çš„ç²¾ç¢ºåº¦å·®ç•° (å–è‡ª DeepBayes 2019 Summer School Day 5, <a href="https://github.com/bayesgroup/deepbayes-2019/blob/master/lectures/day5/1.%20Dmitry%20Kropotov%20-%20MCMC.pdf" target="_blank" rel="external">MCMC slides</a>):</p>
<p><img src="/2022/05/07/Hamiltonian-Monte-Carlo/Untitled.png" width="80%" height="80%"></p>
<p>Leapfrog method æè¿°å¦‚ä¸‹:</p>
<span>$$\begin{align}
p_i(t+\varepsilon/2)=p_i(t)-(\varepsilon/2)\cdot\frac{\partial U(\mathbf{x}(t))}{\partial x_i} \\
x_i(t+\varepsilon)=x_i(t)+\varepsilon \cdot p_i(t+\varepsilon/2) \\
p_i(t+\varepsilon)=p_i(t+\varepsilon/2)-(\varepsilon/2)\cdot\frac{\partial U(\mathbf{x}(t+\varepsilon))}{\partial x_i}
\end{align}$$</span><!-- Has MathJax -->
<p>ä¸»è¦çš„æƒ³æ³•æ˜¯, åœ¨ update $x_i(t+\varepsilon)$ æ™‚ (å¼ (8)), åŸä¾†ä½¿ç”¨ $p_i(t)$ ä¾†æ›´æ–°, æ”¹æˆä½¿ç”¨â€æ›´æº–çš„â€ $p_i(t+\varepsilon/2)$ ä¾†æ›´æ–°, å¦‚åŒå¼ (11). ç„¶å¾Œ $p_i(t+\varepsilon)$ åˆ†æˆå…©æ¬¡çš„ $\varepsilon/2$ steps ä¾†æ›´æ–°.</p>
<blockquote>
<p>æŠ±æ­‰æ²’æœ‰åš´è¬¹çš„æ•¸å­¸ä¾†è­‰æ˜ error çš„ order.</p>
</blockquote>
<p>æ³¨æ„åˆ°, æˆ‘å€‘åªéœ€è¦ $\nabla_\mathbf{x}U(\mathbf{x})$ å°±èƒ½æ›´æ–° $(\mathbf{x},\mathbf{p})$!<br>ä¹Ÿå°±æ˜¯èªªåªè¦æœ‰ potential energy çš„ gradient å°±å¯ä»¥æ¨¡æ“¬ Hamiltonian dynamic!<br>é€™é»å¾ˆé‡è¦, å› ç‚ºè®Šæˆ sampling æ–¹æ³•å¾Œç­‰åŒæ–¼é€™å¥è©±: åªè¦æœ‰ score function å°±èƒ½æ¡æ¨£! è€Œ score function æ€éº¼ä¼°è¨ˆ, <a href="https://bobondemon.github.io/2022/01/08/Estimation-of-Non-Normalized-Statistical-Models-by-Score-Matching/">Score Matching</a> æ˜¯å€‹å¥½æ–¹æ³•.<br>Sample codes from (<a href="https://github.com/bayesgroup/deepbayes-2019/blob/master/seminars/day5/Markov%20Chain%20Monte-Carlo%20Solution.ipynb" target="_blank" rel="external">Markov Chain Monte-Carlo Solution.ipynb</a>):</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">_leapfrog</span><span class="params">(self, x, v)</span>:</span></div><div class="line">    self.energy = []</div><div class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> range(self.n_steps):</div><div class="line">        v -= <span class="number">0.5</span> * self.eps * self.dist.grad_log_density(x)</div><div class="line">        x = x + self.eps * v</div><div class="line">        v -= <span class="number">0.5</span> * self.eps * self.dist.grad_log_density(x)</div><div class="line">        self.energy.append(self._energy(x, v))</div><div class="line">    <span class="keyword">return</span> x, v</div></pre></td></tr></table></figure>
<h2 id="å½ˆç°§ä¾‹å­"><a href="#å½ˆç°§ä¾‹å­" class="headerlink" title="å½ˆç°§ä¾‹å­"></a>å½ˆç°§ä¾‹å­</h2><hr>
<p>åƒè€ƒè‡ª <strong><strong><a href="https://theclevermachine.wordpress.com/2012/11/18/mcmc-hamiltonian-monte-carlo-a-k-a-hybrid-monte-carlo/" target="_blank" rel="external">MCMC: Hamiltonian Monte Carlo (a.k.a. Hybrid Monte Carlo)</a></strong></strong><br>ä¸çŸ¥é“æ€éº¼ä¾†çš„ä¹Ÿæ²’é—œä¿‚, åæ­£æ­¤æ™‚çš„ç³»çµ±èƒ½é‡ç‚º:</p>
<span>$$U(x)=\frac{x^2}{2} \\
K(p)=\frac{p^2}{2} \\
H(x,p)=U(x)+K(p)$$</span><!-- Has MathJax -->
<p>ä½ç½® $x$ çš„åƒè€ƒåŸé»å®šç¾©åœ¨å½ˆç°§ä¸­å¿ƒ, ä¹Ÿå°±æ˜¯å‰›å¥½ potential energy ç‚º $0$ çš„æ™‚å€™. ä½¿ç”¨ Leapfrog method ä¾†æ¨¡æ“¬ Hamiltonian equations æ›´æ–°ç‹€æ…‹ $(\mathbf{x},\mathbf{p})$:</p>
<p><img src="/2022/05/07/Hamiltonian-Monte-Carlo/hamiltoniandynamics.gif" width="70%" height="70%"></p>
<p>å¯ä»¥çœ‹åˆ° Hamiltonian dynamic çš„éç¨‹, èƒ½é‡ä¸Š (å·¦ä¸‹è§’çš„åœ–) åªæ˜¯ potential å’Œ kinetic energy çš„äº’ç›¸äº¤æ› (é»ƒè‰²å’Œé’è‰²äº’ç›¸æ¶ˆé•·), å…¶ç¸½èƒ½é‡æ˜¯ä¸è®Šçš„.<br>å“ä¸å°~ç¸½èƒ½é‡ $H$ çš„é‚£æ¢å…¨é»ƒè‰²çš„ bar æ²’æœ‰å›ºå®šä¸å‹•å•Š, çœ‹èµ·ä¾†é‚„æ˜¯æœƒå°å¹…åº¦ä¸Šä¸Šä¸‹ä¸‹çš„.<br>æ˜¯çš„, ç¸±ä½¿ç”¨äº† Leapfrog method, é‚„æ˜¯æœƒæ¼‚ç§», é€™æ˜¯å› ç‚ºæˆ‘å€‘å°æ™‚é–“é›¢æ•£åŒ–é€ æˆçš„. æƒ³è¦ error æ›´å°, å°±å¿…éœ€åˆ‡æ›´ç´°ç¢çš„æ™‚é–“å»é€¼è¿‘.<br>å¦å¤–éœ€è¦ç‰¹åˆ¥èªªæ˜, å³ä¸‹è§’çš„ â€œ<strong>Phase Space</strong>â€ åœ–, ç•«å‡ºäº† $(x,p)$ ç‹€æ…‹å€¼çš„ç§»å‹•è·¯å¾‘. ç”±æ–¼èƒ½é‡å®ˆæ†, é€™è·¯å¾‘ä»£è¡¨äº†ç›¸åŒçš„ Hamiltonian energy. ç‚ºä»€éº¼è¦ç‰¹åˆ¥èªªæ˜é€™é», åœ¨å¾Œé¢è¬› sampling çš„æ™‚å€™æœƒå†æ¬¡æåˆ°.</p>
<h2 id="èƒ½é‡æ€éº¼çœ‹æˆæ©Ÿç‡åˆ†ä½ˆ-æˆ–åéä¾†"><a href="#èƒ½é‡æ€éº¼çœ‹æˆæ©Ÿç‡åˆ†ä½ˆ-æˆ–åéä¾†" class="headerlink" title="èƒ½é‡æ€éº¼çœ‹æˆæ©Ÿç‡åˆ†ä½ˆ? æˆ–åéä¾†?"></a>èƒ½é‡æ€éº¼çœ‹æˆæ©Ÿç‡åˆ†ä½ˆ? æˆ–åéä¾†?</h2><hr>
<p>çµ¦å®šèƒ½é‡ $E(x)$, ç¸½æ˜¯å¯ä»¥ç”¨ä¸‹å¼è®Šæˆæ©Ÿç‡åˆ†ä½ˆ (Gibbs distribution):</p>
<span>$$p(x)=\frac{1}{Z}e^{-E(x)}$$</span><!-- Has MathJax -->
<p>$Z$ å°±æ˜¯ä¸€å€‹ normalization constant è®Šæˆæ©Ÿç‡åˆ†ä½ˆç”¨çš„. æ‰€ä»¥èƒ½é‡æ„ˆå¤§è¡¨ç¤ºçš„æ©Ÿç‡å¯†åº¦å°±æ„ˆå°.<br>æˆ‘å€‘ä¾†å°‡ Hamiltonian energy è®Šæ©Ÿç‡åˆ†ä½ˆçœ‹çœ‹:</p>
<span>$$p(\mathbf{x},\mathbf{p})=\frac{1}{Z}e^{-H(\mathbf{x},\mathbf{p})} \\
\propto e^{-(U(\mathbf{x})+K(\mathbf{p}))}
=e^{-U(\mathbf{x})}e^{-K(\mathbf{p})}
=p(\mathbf{x})p(\mathbf{p})$$</span><!-- Has MathJax -->
<p>é€™è£¡å¯ä»¥ç™¼ç¾ $\mathbf{x}$ èˆ‡ $\mathbf{p}$ äº’ç›¸ç¨ç«‹.<br>åŸæœ¬å¾ç‰©ç†é‚£é‚Šæˆ‘å€‘æ˜¯å…ˆå®šç¾©äº†èƒ½é‡, å†åˆ©ç”¨ Gibbs distribution è®Šæˆäº†æ©Ÿç‡åˆ†ä½ˆ.<br>ç¾åœ¨æˆ‘å€‘åéä¾†æ“ä½œ: å…ˆå®šç¾©æˆ‘å€‘è¦çš„æ©Ÿç‡åˆ†ä½ˆ, ç„¶å¾Œåæ¨èƒ½é‡é•·ä»€éº¼æ¨£.</p>
<blockquote>
<p>ğŸ¤” é¡Œå¤–è©±, å¯«åˆ°é€™æˆ‘å°±åœ¨æƒ³, åéä¾†å¾å…ˆå®šç¾©æ©Ÿç‡åˆ†å¸ƒå†æ¨å°èƒ½é‡æ˜¯ä¸æ˜¯ä»ç„¶èƒ½æ»¿è¶³ energy conservation?<br>i.e. èƒ½é‡éš¨æ™‚é–“ä¸è®Š.<br><span>$$\begin{align}
\frac{dH(x,p)}{dt}=0
\end{align}$$</span><!-- Has MathJax --><br>ä½†å…¶å¯¦ä¸ç”¨æ“”å¿ƒ, å› ç‚ºåªè¦ç”¨ Hamiltonian equations (6), (7) å»æ›´æ–°ç‹€æ…‹, å°±æœƒæ»¿è¶³ energy conservation.<br>æˆ‘å€‘è€ƒæ…® 1-D case å³å¯, èƒ½é‡ç‚º $H(x(t),p(t))$, æ»¿è¶³ (6) and (7) ä¸¦è§€å¯Ÿ<br><span>$$\frac{dH(x(t),p(t))}{dt}=\frac{dH}{dx}\frac{dx}{dt}+\frac{dH}{dp}\frac{dp}{dt} \\
\text{by }(6)=\frac{dH}{dx}\frac{dH}{dp}+\frac{dH}{dp}\frac{dp}{dt} \\
\text{by }(7)=\frac{dH}{dx}\frac{dH}{dp}-\frac{dH}{dp}\frac{dH}{dx}=0$$</span><!-- Has MathJax --></p>
</blockquote>
<p>å› ç‚ºäº’ç›¸ç¨ç«‹, æˆ‘å€‘å¯ä»¥å…ˆå®šç¾© $\mathbf{p}$ æ˜¯ normal distribution $\mathcal{N}(\mathbf{p}|0,I)$</p>
<span>$$p(\mathbf{p})=\frac{1}{Z_\mathbf{p}}e^{-\frac{\mathbf{p}^T\mathbf{p}}{2}}$$</span><!-- Has MathJax -->
<p>å¯ä»¥çœ‹å¾—å‡ºä¾†å…¶ (kinetic) energy ç‚º:</p>
<span>$$\begin{align}
K(\mathbf{p})=\frac{\mathbf{p}^T\mathbf{p}}{2}
\end{align}$$</span><!-- Has MathJax -->
<p>ç„¶å¾Œä¸è¦å¿˜è¨˜æˆ‘å€‘çš„ç›®çš„æ˜¯è¦å¾ä¸€å€‹ç›®æ¨™åˆ†ä½ˆ <span>$p^*(\mathbf{x})$</span><!-- Has MathJax --> å–æ¨£, å› æ­¤ $\mathbf{x}$ çš„æ©Ÿç‡åˆ†ä½ˆå°±ç›´æ¥å®šç¾©æˆç›®æ¨™åˆ†ä½ˆ. è€Œå…¶ (potential) energy ç‚º:</p>
<span>$$\begin{align}
p^*(\mathbf{x})=\frac{1}{Z_\mathbf{x}}e^{-U(\mathbf{x})} \\
\Longrightarrow U(\mathbf{x})=-\log p^*(\mathbf{x}) + \text{const.}
\end{align}$$</span><!-- Has MathJax -->
<p>é‚„è¨˜å¾—æˆ‘å€‘ä¹‹å‰èªªéé€™å¥è©±å—? â€œæˆ‘å€‘åªéœ€è¦ <span>$\nabla_\mathbf{x}U(\mathbf{x})$</span><!-- Has MathJax --> å°±èƒ½æ›´æ–° $(\mathbf{x},\mathbf{p})$!â€<br>å› æ­¤ (16) çš„ $\text{const.}$ å°±ä¸é‡è¦äº†, æ‰€ä»¥ potential energy é€™éº¼å®šç¾©å°±å¯ä»¥äº†:</p>
<span>$$\begin{align}
U(\mathbf{x})=-\log p^*(\mathbf{x})
\end{align}$$</span><!-- Has MathJax -->
<h2 id="MHC-æ¡æ¨£éç¨‹"><a href="#MHC-æ¡æ¨£éç¨‹" class="headerlink" title="MHC æ¡æ¨£éç¨‹"></a>MHC æ¡æ¨£éç¨‹</h2><hr>
<p>å¥½äº†, åˆ°ç›®å‰ç‚ºæ­¢æˆ‘å€‘è—‰ç”±è¨­å®šå¥½çš„ distribution <span>$p^*(\mathbf{x}),\mathcal{N}(\mathbf{p}|0,I)$</span><!-- Has MathJax -->, å¯ä»¥æ‰¾åˆ°å°æ‡‰çš„ energy functions $U(\mathbf{x}),K(\mathbf{p})$.<br>é‚£å°±å¯ä»¥å¥—ç”¨  Hamiltonian equations (6), (7) ä¾†æ¨¡æ“¬èƒ½é‡ä¸è®Šçš„æƒ…å½¢ä¸‹, $(\mathbf{x},\mathbf{p})$ éš¨æ™‚é–“çš„è®ŠåŒ–.<br>çµ¦å®šä¸€å€‹åˆå§‹ç‹€æ…‹ $(\mathbf{x}_0,\mathbf{p}_0)$ å¯ä»¥å¾—åˆ°:</p>
<span>$$(\mathbf{x}_0,\mathbf{p}_0)\xrightarrow[]{(6)(7)}(\mathbf{x}_1,\mathbf{p}_1)\xrightarrow[]{(6)(7)}(\mathbf{x}_2,\mathbf{p}_2)\xrightarrow[]{(6)(7)}...$$</span><!-- Has MathJax -->
<p>å…¶ä¸­ <span>$H(\mathbf{x}_0,\mathbf{p}_0)=H(\mathbf{x}_1,\mathbf{p}_1)=...$</span><!-- Has MathJax --><br>å¯¦ä½œä¸Šç”±æ–¼æ¯ä¸€æ¬¡ (6), (7) çš„æ›´æ–°éƒ½æ¡ç”¨å¾ˆå°çš„ $\varepsilon$ (Leapfrog sample codes è£¡çš„ <code>self.eps</code>), é€™æ¨£æ‰èƒ½ç¢ºä¿å¤ æº–ç¢º.<br>ä½†æˆ‘å€‘ä¹Ÿå¸Œæœ›èƒ½å¤ èµ°é ä¸€äº› (é€™å° multi-modual çš„ distribution å¾ˆæœ‰å¹«åŠ©, å¦‚ä¸‹åœ–æ‰€ç¤º), æ‰€ä»¥æœƒè·‘å€‹ $T$ æ­¥ updates (Leapfrog sample codes è£¡çš„ <code>self.n_steps</code>)</p>
<p><img src="/2022/05/07/Hamiltonian-Monte-Carlo/Untitled 1.png" width="80%" height="80%"></p>
<p>ä½†å°±ç®—å¦‚æ­¤, ç”±æ–¼ energy conservation (13) çš„é—œä¿‚, $\mathbf{x}$ åªæœƒåœ¨ phase space ä¸Šå…·æœ‰ç›¸åŒèƒ½é‡çš„ contour ä¸Šæ¡æ¨£.<br>(Phase space å®šç¾©ç‚º $(\mathbf{x},\mathbf{p})$ çš„ç©ºé–“)<br>ç‚ºäº†èƒ½å¤ æ¡æ¨£å‡ºå…¶å®ƒçš„é», æˆ‘å€‘éœ€è¦æ›åˆ°å…¶ä»–èƒ½é‡çš„ contour, å› æ­¤æ”¹è®Š $\mathbf{p}$, å³å°å®ƒé‡æ–°æ¡æ¨£å³å¯.<br>(follow ä¹‹å‰å®šç¾©å¥½çš„åˆ†ä½ˆ <span>$\mathcal{N}(\mathbf{p}|0,I)$</span><!-- Has MathJax -->).<br>ä½†æ˜¯åˆ¥å¿˜äº†, Hamiltonian MC æ‰€æå‡ºçš„æ¡æ¨£æ˜¯ Metorpolis-Hastings çš„ <strong>proposal distribution</strong>. æ‰€ä»¥ä¹Ÿéœ€è¦æœ‰ accept/reject, ä½†ä¹Ÿå¾—ç›Šæ–¼ energy conservation æ‰€ä»¥æœƒæœ‰éå¸¸é«˜çš„ accept rate. å› è€Œæ¡æ¨£æ•ˆç‡å¾ˆå¥½.<br>ç¸½çµä¸€ä¸‹ HMC æ–¹æ³• [<a href="https://github.com/bayesgroup/deepbayes-2019/blob/master/lectures/day5/1.%20Dmitry%20Kropotov%20-%20MCMC.pdf" target="_blank" rel="external">ref 3</a>]:</p>
<p><img src="/2022/05/07/Hamiltonian-Monte-Carlo/Untitled 2.png" width="80%" height="80%"></p>
<p>è€Œ Tuning HMC æœ‰å¹¾å€‹è¦é» [<a href="https://github.com/bayesgroup/deepbayes-2019/blob/master/lectures/day5/1.%20Dmitry%20Kropotov%20-%20MCMC.pdf" target="_blank" rel="external">ref 3</a>]:</p>
<p><img src="/2022/05/07/Hamiltonian-Monte-Carlo/Untitled 3.png" width="80%" height="80%"></p>
<p>ä¸€èˆ¬ä¾†èªªè¦æ§åˆ¶ rejection rate åœ¨ $[1/4,3/4]$ ä¹‹é–“æœƒæ¯”è¼ƒå¥½. é‚„æœ‰å¤šè·‘å¹¾å€‹ threads ä¾†ç¢ºèªæ”¶æ–‚ç‹€æ³.</p>
<h2 id="èˆ‡-Langevin-Dynamics-çš„é—œä¿‚"><a href="#èˆ‡-Langevin-Dynamics-çš„é—œä¿‚" class="headerlink" title="èˆ‡ Langevin Dynamics çš„é—œä¿‚"></a>èˆ‡ Langevin Dynamics çš„é—œä¿‚</h2><hr>
<p>å…ˆç¸½çµä¸€ä¸‹ Hamiltonian Monte Carlo (HMC) æ˜¯ <a href="https://bobondemon.github.io/2021/10/27/MCMC-by-Gibbs-and-Metropolis-Hasting-Sampling/">Metropolis-Hastings (MH)</a> æ–¹æ³•çš„ä¸€ç¨®, åªæ˜¯ proposal distribution å¾ random walk æ”¹æˆä½¿ç”¨ Hamiltonian dynamics ä¾†åš (å¼ (6)(7) çš„æ›´æ–°)<br>HMC æœ‰ä¸€å€‹ç‰¹é»æ˜¯, å¯ä»¥åªç”¨ <span>$\nabla_\mathbf{x}U(\mathbf{x})$</span><!-- Has MathJax --> å°±èƒ½å°ç›®æ¨™åˆ†ä½ˆ <span>$p(\mathbf{x})$</span><!-- Has MathJax --> å–æ¨£, èªªç²¾ç¢ºä¸€é»æ˜¯å° joint pdf <span>$p(\mathbf{x}, \mathbf{p})$</span><!-- Has MathJax --> æ¡æ¨£, æˆ‘å€‘é€é MH çš„ accept/rejection æ©Ÿåˆ¶è®Šæˆå° <span>$p(\mathbf{x})$</span><!-- Has MathJax --> å–æ¨£<br>å¯¦å‹™ä¸Š Hamiltonian dynamics çš„æ›´æ–°æ­¥é©Ÿä½¿ç”¨ leapfrog method (å¼ (10)-(12)), å¦‚æœåªç”¨ single leapfrog step å…¶å¯¦å°± reduce æˆ Langevin Monte Carlo (LMC) [<a href="https://idea-stat.snu.ac.kr/seminar/20180705/HMC.pdf" target="_blank" rel="external">6</a>], è€Œå…¶æ›´æ–°æ­¥é©Ÿå°±ç¨±ç‚º Langevin Dynamics<br>æ“·å–åƒè€ƒè³‡æ–™[<a href="https://idea-stat.snu.ac.kr/seminar/20180705/HMC.pdf" target="_blank" rel="external">6</a>]æœ€å¾Œä¸€é :</p>
<p><img src="/2022/05/07/Hamiltonian-Monte-Carlo/Langevin_Monte_Carlo.png" width="80%" height="80%"></p>
<p>é€šå¸¸åœ¨ <a href="https://arxiv.org/abs/2006.11239" target="_blank" rel="external">DDPM (Denoising Diffusion Probabilistic Models)</a> or <a href="https://bobondemon.github.io/2022/03/26/Generative-Modeling-by-Estimating-Gradients-of-the-Data-Distribution/">SMLD</a> (å¦‚åŒæœ¬æ–‡é–‹é ­èªªçš„é€™å…©å€‹åªæ˜¯ä¸åŒè§’åº¦ä¸‹çœ‹ç›¸åŒçš„å•é¡Œ) è£¡é¢ç”¨ Langevin Dynamics æ›´æ–°å¾Œ, ç›´æ¥çœç•¥ MH çš„ accept/reject æ©Ÿåˆ¶.<br>é‡è¤‡ä¸€ä¸‹ä¸Šé¢æŠ•å½±ç‰‡å¯«çš„ Langevin Dynamics:<br><span>$$\begin{align}
\Delta\mathbf{x}=\frac{\delta^2}{2}\nabla_\mathbf{x}\log p(\mathbf{x}) + \delta\mathbf{p}
\end{align}$$</span><!-- Has MathJax --> å…¶ä¸­ $\mathbf{p}$ ä¸€æ¨£å¾ $\mathcal{N}(\mathbf{p}|0,I)$ æ¡æ¨£<br>æ‰€ä»¥åœ¨ SMLD ä¸­, ç›®æ¨™å°±æ˜¯è¨“ç·´å‡º score function NN <span>$s_\theta(\mathbf{x})$</span><!-- Has MathJax --> ä¾†å–ä»£ <span>$\nabla_\mathbf{x}\log p(\mathbf{x})$</span><!-- Has MathJax --> å°±å¯ä»¥ç”¨ score function æ¡æ¨£äº†<br>æœ€å¾Œ Langevin Dynamics æ¡æ¨£é‚„å¯ä»¥å¾å¦ä¸€ç¨®æ–¹å¼æ¨å°: å…ˆå‡è¨­ç²’å­é‹å‹•éµå¾ Langevin Dynamics å¯ä»¥ç™¼ç¾æ¯å€‹æ™‚é–“é»ç²’å­çš„æ©Ÿç‡åˆ†ä½ˆéµå¾ Fokker-Planck equation, è€Œç•¶æ™‚é–“é»ç„¡çª®å¤§æ™‚, Fokker-Planck equation å¯ä»¥ç™¼ç¾æœƒæœ‰ç©©æ…‹åˆ†ä½ˆ, æ‰€ä»¥åå‘ä¾†èªªå¦‚æœç©©æ…‹åˆ†ä½ˆèƒ½è¨­å®šæˆæˆ‘å€‘è¦æ¡æ¨£çš„ç›®æ¨™åˆ†ä½ˆ, é‚£ä¸€åˆ‡å°±å¤§åŠŸå‘Šæˆ! (è¨±ä¹…ä¹‹å‰é–±è®€çš„, å¦‚æœ‰éŒ¯èª¤æ­¡è¿åŒ…å«ä¸¦æŒ‡è­‰)<br>[DeepBayes2019] Day 5, Lecture 3. Langevin dynamics for sampling and global optimization [<a href="https://www.youtube.com/watch?v=3-KzIjoFJy4" target="_blank" rel="external">YouTube</a>], å½±ç‰‡çš„è§£èªªçœŸçš„éå¸¸æ£’, å¯ä»¥ä¸€æ­¥ä¸€æ­¥è·Ÿè‘—æ¨å°ç†è§£! æˆ–ç›´æ¥åƒè€ƒ <a href="https://odie2630463.github.io/2020/09/28/langevin/" target="_blank" rel="external">odieâ€™s Whisper çš„ç­†è¨˜</a>.<br>MCMC, Metropolis Hastings, Hamiltonian Dynamic, Langevin Dynamics, Fokker-Planck equation, Score Maching and DDPM é€™ä¸€ç³»åˆ—é¾å¤§ä¸”ç²¾ç¾çš„æ•¸å­¸ä¸²é€£èµ·ä¾†ç¾åœ¨é™¤äº† LLM ä¹‹å¤–, å¦ä¸€ç¨®å¼·å¤§çš„ GenAI (e.g. <a href="https://imagen.research.google/" target="_blank" rel="external">Imagen</a>, <a href="https://www.midjourney.com/home" target="_blank" rel="external">Midjourney</a>, <a href="https://stability.ai/" target="_blank" rel="external">Stability AI</a>, â€¦). è®“æˆ‘å€‘ä¸€èµ·å¿µå’’èª: Diffusion model è¬æ­², è¬è¬æ­²</p>
<p>ä½†è€å¯¦èªªæˆ‘å¿«è¦è¢«æ·¹æ²’äº†â€¦ æ•‘å‘½å•Šâ€¦ å’•åš•å’•åš•</p>
<hr>
<h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><ol>
<li><a href="https://zhuanlan.zhihu.com/p/67691581" target="_blank" rel="external">é©¬å°”å¯å¤«é“¾è’™ç‰¹å¡æ´›ç®—æ³• (äºŒ) HMC</a></li>
<li><a href="https://theclevermachine.wordpress.com/2012/11/18/mcmc-hamiltonian-monte-carlo-a-k-a-hybrid-monte-carlo/" target="_blank" rel="external">MCMC: Hamiltonian Monte Carlo (a.k.a. Hybrid Monte Carlo)</a></li>
<li>DeepBayes 2019 Summer School Day 5, <a href="https://github.com/bayesgroup/deepbayes-2019/blob/master/lectures/day5/1.%20Dmitry%20Kropotov%20-%20MCMC.pdf" target="_blank" rel="external">MCMC slides</a></li>
<li>MHC sample codes from (<a href="https://github.com/bayesgroup/deepbayes-2019/blob/master/seminars/day5/Markov%20Chain%20Monte-Carlo%20Solution.ipynb" target="_blank" rel="external">https://github.com/bayesgroup/deepbayes-2019/blob/master/seminars/day5/Markov Chain Monte-Carlo Solution.ipynb</a>)</li>
<li>Leapfrog method: <a href="https://www2.atmos.umd.edu/~ekalnay/syllabi/AOSC614/NWP-CH03-2-2.pdf" target="_blank" rel="external">https://www2.atmos.umd.edu/~ekalnay/syllabi/AOSC614/NWP-CH03-2-2.pdf</a></li>
<li><a href="https://idea-stat.snu.ac.kr/seminar/20180705/HMC.pdf" target="_blank" rel="external">Hamiltonian Monte Carlo and Langevin Monte Carlo</a></li>
<li><a href="https://arxiv.org/abs/2006.11239" target="_blank" rel="external">Denoising Diffusion Probabilistic Models</a></li>
<li><a href="https://arxiv.org/abs/2011.13456" target="_blank" rel="external">Score-Based Generative Modeling through Stochastic Differential Equations</a></li>
<li>[DeepBayes2019] Day 5, Lecture 3. Langevin dynamics for sampling and global optimization [<a href="https://www.youtube.com/watch?v=3-KzIjoFJy4" target="_blank" rel="external">YouTube</a>]</li>
<li>odieâ€™s Whisper, <a href="https://odie2630463.github.io/2020/09/28/langevin/" target="_blank" rel="external">Langevin Dynamics æŠ½æ¨£æ–¹æ³•</a></li>
</ol>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        
  <ul class="post-copyright">
    <li class="post-copyright-author">
      <strong>Post authorï¼š</strong>
      Chih-Sheng Chen
    </li>
    <li class="post-copyright-link">
      <strong>Post linkï¼š</strong>
      <a href="https://bobondemon.github.io/2022/05/07/Hamiltonian-Monte-Carlo/" title="å¿˜è¨˜ç‰©ç†ä¹Ÿè¦ææ‡‚çš„ Hamiltonian Monte Carlo (HMC) ç­†è¨˜">https://bobondemon.github.io/2022/05/07/Hamiltonian-Monte-Carlo/</a>
    </li>
    <li class="post-copyright-license">
      <strong>Copyright Noticeï¼š </strong>
      All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/3.0/" rel="external nofollow" target="_blank">CC BY-NC-SA 3.0</a> unless stating additionally.
    </li>
  </ul>


      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/Langevin-Dynamics/" rel="tag"># Langevin Dynamics</a>
          
            <a href="/tags/MCMC/" rel="tag"># MCMC</a>
          
            <a href="/tags/HMC/" rel="tag"># HMC</a>
          
            <a href="/tags/Metropolis-Hastings/" rel="tag"># Metropolis Hastings</a>
          
            <a href="/tags/Hamiltonian-Dynamic/" rel="tag"># Hamiltonian Dynamic</a>
          
            <a href="/tags/Hamiltonian-Monte-Carlo/" rel="tag"># Hamiltonian Monte Carlo</a>
          
            <a href="/tags/Langevin-Monte-Carlo/" rel="tag"># Langevin Monte Carlo</a>
          
            <a href="/tags/Denoising-Diffusion-Probabilistic-Models/" rel="tag"># Denoising Diffusion Probabilistic Models</a>
          
            <a href="/tags/Diffusion-Model/" rel="tag"># Diffusion Model</a>
          
        </div>
      

      
        
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2022/03/26/Generative-Modeling-by-Estimating-Gradients-of-the-Data-Distribution/" rel="next" title="Score Matching ç³»åˆ— (äº”) SM åŠ ä¸Š Langevin Dynamics è®Šæˆç”Ÿæˆæ¨¡å‹">
                <i class="fa fa-chevron-left"></i> Score Matching ç³»åˆ— (äº”) SM åŠ ä¸Š Langevin Dynamics è®Šæˆç”Ÿæˆæ¨¡å‹
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2022/05/15/Numerical-Methods-for-Ordinary-Differential-Equations/" rel="prev" title="Numerical Methods for Ordinary Differential Equations">
                Numerical Methods for Ordinary Differential Equations <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            æ–‡ç« ç›®éŒ„
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            æœ¬ç«™æ¦‚è¦½
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/uploads/avatar.png"
               alt="Chih-Sheng Chen" />
          <p class="site-author-name" itemprop="name">Chih-Sheng Chen</p>
           
              <p class="site-description motion-element" itemprop="description"></p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">102</span>
                <span class="site-state-item-name">æ–‡ç« </span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/categories/index.html">
                <span class="site-state-item-count">5</span>
                <span class="site-state-item-name">åˆ†é¡</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">216</span>
                <span class="site-state-item-name">æ¨™ç±¤</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#Hamiltonian-dynamic"><span class="nav-number">1.</span> <span class="nav-text">Hamiltonian dynamic</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#å½ˆç°§ä¾‹å­"><span class="nav-number">2.</span> <span class="nav-text">å½ˆç°§ä¾‹å­</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#èƒ½é‡æ€éº¼çœ‹æˆæ©Ÿç‡åˆ†ä½ˆ-æˆ–åéä¾†"><span class="nav-number">3.</span> <span class="nav-text">èƒ½é‡æ€éº¼çœ‹æˆæ©Ÿç‡åˆ†ä½ˆ? æˆ–åéä¾†?</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#MHC-æ¡æ¨£éç¨‹"><span class="nav-number">4.</span> <span class="nav-text">MHC æ¡æ¨£éç¨‹</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#èˆ‡-Langevin-Dynamics-çš„é—œä¿‚"><span class="nav-number">5.</span> <span class="nav-text">èˆ‡ Langevin Dynamics çš„é—œä¿‚</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#References"><span class="nav-number">6.</span> <span class="nav-text">References</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Chih-Sheng Chen</span>
</div>


<div class="powered-by">
  ç”± <a class="theme-link" href="https://hexo.io">Hexo</a> å¼·åŠ›é©…å‹•
</div>

<div class="theme-info">
  ä¸»é¡Œ -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div>



        
<div class="busuanzi-count">
  <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv">
      <i class="fa fa-user"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
      [object Object]
    </span>
  

  
    <span class="site-pv">
      <i class="fa fa-eye"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
      [object Object]
    </span>
  
</div>


        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  




  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.0"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.0"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({"tex2jax":{"inlineMath":[["$","$"],["\\(","\\)"]],"skipTags":["script","noscript","style","textarea","pre","code"],"processEscapes":true},"TeX":{"equationNumbers":{"autoNumber":"AMS"}}});
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->



  



  




	





  





  





  






  





  

  

  

  

</body>
</html>
